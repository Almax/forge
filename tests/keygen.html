<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <script type="text/javascript" src="forge/util.js"></script>
  <script type="text/javascript" src="forge/sha256.js"></script>
  <script type="text/javascript" src="forge/cipher.js"></script>
  <script type="text/javascript" src="forge/cipherModes.js"></script>
  <script type="text/javascript" src="forge/aes.js"></script>
  <script type="text/javascript" src="forge/prng.js"></script>
  <script type="text/javascript" src="forge/random.js"></script>
  <script type="text/javascript" src="forge/jsbn.js"></script>
  <script type="text/javascript" src="forge/asn1.js"></script>
  <script type="text/javascript" src="forge/pem.js"></script>
  <script type="text/javascript" src="forge/rsa.js"></script>
  <script type="text/javascript" src="forge/prime.js"></script>
</head>

<body>

<script type="text/javascript">

function async() {
  var bits = 1024;
  console.log('Generating ' + bits + '-bit key-pair...');
  var st = +new Date();
  forge.pki.rsa.generateKeyPair({
    bits: bits,
    workers: -1,
    /*workLoad: 100,*/
    workerScript: 'forge/prime.worker.js'
  }, function(err, keypair) {
    var et = +new Date();
    console.log('Key-pair created in ' + (et - st) + 'ms.');
    //console.log('private', forge.pki.privateKeyToPem(keypair.privateKey));
    //console.log('public', forge.pki.publicKeyToPem(keypair.publicKey));
  });
}

function sync() {
  var bits = 1024;
  console.log('Generating ' + bits + '-bit key-pair...');
  var st = +new Date();
  var keypair = forge.pki.rsa.generateKeyPair(bits);
  var et = +new Date();
  console.log('Key-pair created in ' + (et - st) + 'ms.');
  //console.log('private', forge.pki.privateKeyToPem(keypair.privateKey));
  //console.log('public', forge.pki.publicKeyToPem(keypair.publicKey));
}

//async();
//sync();

var st = +new Date();
forge.prime.generateProbablePrime(
  1024, {
    algorithm: {
      name: 'PRIMEINC',
      options: {
        //workers: 8
      }
    }
  }, function(err, num) {
    var et = +new Date();
    console.log('num', num.toString(16));
    console.log('time', (et - st) + 'ms');
  });

</script>

</body>
</html>
